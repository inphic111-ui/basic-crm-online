
  // Open classify modal
  const handleOpenClassifyModal = (record) => {
    setClassifyingRecord(record);
    setClassifyForm({
      customer_id: record.customer_id || '',
      business_name: record.business_name || ''
    });
    setShowClassifyModal(true);
  };

  // Close classify modal
  const handleCloseClassifyModal = () => {
    setShowClassifyModal(false);
    setClassifyingRecord(null);
    setClassifyForm({ customer_id: '', business_name: '' });
  };

  // Save classification
  const handleSaveClassify = async () => {
    if (!classifyForm.customer_id || !classifyForm.business_name) {
      alert('Please fill in customer and business');
      return;
    }

    try {
      const response = await fetch('/api/audio/parse-and-update', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          recordId: classifyingRecord.id,
          filename: classifyingRecord.audio_filename,
          customerId: classifyForm.customer_id,
          businessName: classifyForm.business_name
        })
      });

      if (!response.ok) throw new Error('Failed to save classification');
      
      const result = await response.json();
      console.log('Classification saved', result);
      
      fetchRecords();
      handleCloseClassifyModal();
      alert('Classification saved successfully');
    } catch (error) {
      console.error('Failed to save classification:', error);
      alert(`Save failed: ${error.message}`);
    }
  };
